/* grips (c) 2012 Kyle Simpson | http://getify.mit-license.org/ */
;Object.keys||(Object.keys=function(t){var n,r=[];for(n in t)t.hasOwnProperty(n)&&r.push(n);return r}),Object.create||(Object.create=function(t){function n(){}return n.prototype=t,new n}),Object.prototype.toJSON||(Object.prototype.toJSON=function(){function t(e){for(var t=0;t<r.length;t++)if(r[t]===e)return!0;return!1}function n(e){function i(e){if(typeof e=="object"){if(e!==null){if(Date===e.constructor||Number===e.constructor||Boolean===e.constructor||String===e.constructor||RegExp===e.constructor)return e;if(!t(e))return n(e)}return null}return e}var s,o,u;if(Object.prototype.toString.call(e)==="[object Array]"){r.push(e),o=[];for(s=0;s<e.length;s++)o.push(i(e[s]));return r.pop(),o}if(typeof e=="object"){if(e!==null){if(Date===e.constructor||Number===e.constructor||String===e.constructor||Boolean===e.constructor||RegExp===e.constructor)return e;if(!t(e)){r.push(e),o={};for(s in e)e.hasOwnProperty(s)&&(u=i(e[s]),u!==null&&(o[s]=u));return r.pop(),o}}return null}return e}var r=[],i;return i=n(this),r=[],i},Object.defineProperty&&Object.defineProperty(Object.prototype,"toJSON",{enumerable:!1})),function(t){function r(){function i(){}function s(){var e=t.grips;return t.grips=n,e}function o(e){e in p||(p[e]={collection:"",extend:null,partials:{}})}function u(e,t){o(e),p[e].extend=t}function a(e){var t,n,r;if(typeof e=="object"){if(e===null)return e;if(Object.prototype.toString.call(e)==="[object Array]"){n=[];for(t=0;t<e.length;t++)typeof e[t]=="object"?r=a(e[t]):r=e[t],n.push(r)}else{e instanceof i?n=new i:n={};for(t in e)e.hasOwnProperty(t)&&(typeof (e[t]==="object")?r=a(e[t]):r=e[t],n[t]=r)}}else n=e;return n}function f(t,n,r,i){return r="["+t+"] "+r,i&&(r+="; "+i.toString()),new e(r,n,i?i.stack:null)}function l(t,n,r){var i=n.match(/^(.+)#/);i&&(i=i[1]);if(!i)throw new e("Missing collection ID: "+n)||d;o(i),p[i].partials[n.replace(/^.*#/,"#")]=function(){var n,s;try{s=t.apply(h,arguments)}catch(o){throw n=f(i,r,"Unexpected error",o),n.stack=o.stack,n}if(s instanceof Error)throw s;return s}}function c(t,n,r){if(!t)return"";var i,s,o,u,a=[],f=!1,l=!1;i=t.match(/^(.+)#/),i&&(i=i[1],f=!0);if(!f&&v.length>0)i=v[v.length-1];else if(!f||v.length>0&&v[v.length-1]===i){if(!i)throw new e("Required collection ID missing: "+t)||d}else v.push(i),l=!0;if(i in p){t=t.replace(/^(.+)#/,"#"),u=i+t,m.push(u);for(o=0;o<m.length-1;o++)if(m[o]===u)throw new e("Recursive template include: "+u)||d;f?a.push(i):a=a.concat(v);if(!(t in p[i].partials)&&p[i].extend){u=p[i].extend;while(u&&u in p)a.push(u),u=p[u].extend}for(o=0;o<a.length;o++)if(t in p[a[o]].partials){s=p[a[o]].partials[t](n,r);break}}if(s)return m.pop(),l&&v.pop(),s;throw new e("["+t+"] Template not found")||d}var e=function(){function n(){}function r(e,r,i){var s=this===t?new n:this;return s.message=e,s.ref=r,s.stack=i,s}return n.prototype=r.prototype=Object.create(ReferenceError.prototype),r.prototype.constructor=r,r.prototype.toString=function(){var t="TemplateError: "+this.message;return this.ref&&(t+="; "+JSON.stringify(this.ref)),t=t.replace(/[\n\r]+/g," ").replace(/\s+/g," "),this.stack&&(t+="\n"+this.stack),t},r}(),h,p={},d=new Error("Unknown error"),v=[],m=[];return h={extend:u,cloneObj:a,error:f,definePartial:l,render:c,TemplateError:e,noConflict:s,sandbox:r,RangeLiteralHash:i},h}var n=t.grips;t.grips=r()}(this);